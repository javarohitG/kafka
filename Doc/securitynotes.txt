
Security:

Authentication : who you are

Authentication: what rights you have

data integrity: ensures that the data sent is the data received.

data confidentiality: ensures that the data is not visible to any one other than the sender and receiver.

SASL : Simple Authentication Security Layer---------authentication and authorization
SSL: Secure Socket Layer-----------data integrity and confidentiality

SASL is based on JAAS api

JAAS-----------Java Authentication and Authorization Service

step 1:

create a copy of server.properties and name it as server-secure.properties and add the following content to it.

listeners=SASL_PLAINTEXT://localhost:9092
security.inter.broker.protocol=SASL_PLAINTEXT
sasl.mechanism.inter.broker.protocol=PLAIN
sasl.enabled.mechanisms=PLAIN

step 2:

create a file called server-jaas.config under the config directory and add the following content to it.

KafkaServer {
   org.apache.kafka.common.security.plain.PlainLoginModule required
   username="admin"
   password="admin-secret"
   user_admin="admin-secret"
   user_alice="alice-secret"
   user_user1="pass1";
};


step 3:
if the kafka server and zookeeper are running, terminate them and clear tmp directory.


step 4:

KAFKA_OPTS is an environment variable where we can specify additional jvm parameters needed for kafka tools.

start the zookeeper. (in a new command window).

open another command window and execute the following commands to start the karka server in secure mode.

C:\kafka_2.12-2.5.0>set KAFKA_OPTS=-Djava.security.auth.login.config=config/server-jaas.config

C:\kafka_2.12-2.5.0>bin\windows\kafka-server-start.bat config\server-secure.properties

step 5:

create a directory called clientproducer under c:\ and create a file called client.properties with the following content.
security.protocol=SASL_PLAINTEXT
sasl.mechanism=PLAIN
step 6:
create a file called producer-jaas.config under c:\clientproducer and add the following content.

KafkaClient {
  org.apache.kafka.common.security.plain.PlainLoginModule required
  username="alice"
  password="alice-secret";
};

step 7:
create a new topic called test-security-topic.


step 8:

start an authenticated producer.

C:\kafka_2.12-2.5.0\bin\windows>set KAFKA_OPTS=-Djava.security.auth.login.config=c:/clientproducer/producer-jaas.config

C:\kafka_2.12-2.5.0\bin\windows>kafka-console-producer.bat --topic test-security-topic --bootstrap-server localhost:9092  --producer.config=c:/clientproducer/client.properties



step 9:

start an authenticated consumer



create a directory called clientconsumer under c:\ and create a file called client.properties with the following content.
security.protocol=SASL_PLAINTEXT
sasl.mechanism=PLAIN

create a file called consumer-jaas.config under c:\clientconsumer and add the following content.

KafkaClient {
  org.apache.kafka.common.security.plain.PlainLoginModule required
  username="user1"
  password="pass1";
};




open a new command window and type the following commands to start an authenticated consumer.

C:\kafka_2.12-2.5.0\bin\windows>set KAFKA_OPTS=-Djava.security.auth.login.config=c:/clientconsumer/consumer-jaas.config

C:\kafka_2.12-2.5.0\bin\windows>kafka-console-consumer.bat --topic test-security-topic --consumer.config=c:/clientconsumer/client.properties --bootstrap-server localhost:9092
















